<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link th:href="@{/node_modules/bootstrap/dist/css/bootstrap.min.css}" rel="stylesheet">
  <link th:href="@{/scss/custom.css}" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
  <title>Elegir Paquete</title>
</head>

<body class="bg-white">
  <header th:replace="~{fragments/header :: navBar}"></header>

  <div class="position-relative m-4 p-5">
    <div class="position-relative m-4">
      <div class="progress" role="progressbar" style="height: 1px;">
        <div class="progress-bar bg-ocean" style="width: 75%"></div>
      </div>
      <button type="button" class="position-absolute top-0 start-0 translate-middle btn btn-sm btn-ocean rounded-pill" style="width: 2rem; height:2rem;">1</button>
      <button type="button" class="position-absolute top-0 start-50 translate-middle btn btn-sm btn-ocean rounded-pill" style="width: 2rem; height:2rem;">2</button>
      <button type="button" class="position-absolute top-0 start-100 translate-middle btn btn-sm btn-ocean rounded-pill" style="width: 2rem; height:2rem;">3</button>
    </div>
  </div>

  <main class="container">
    <h1 class="text-center text-dark mb-4">Selecciona tu paquete</h1>

    <form th:action="@{/guardarPaquete}" method="post" class="needs-validation" novalidate>
      <div class="mb-3">
        <label for="paqueteSelect" class="form-label">Paquete disponible</label>
        <select class="form-select" id="paqueteSelect" name="nombrePaquete" required>
          <option disabled selected value="">-- Selecciona un paquete --</option>
          <option th:each="paquete : ${paquetes}" 
                  th:value="${paquete.nombre_paq}"
                  th:text="${paquete.nombre_paq}">
          </option>
        </select>
        <div class="invalid-feedback">Debes seleccionar un paquete.</div>
      </div>

      <div id="infoPaquete" class="card border-secondary p-3" th:if="${paquetes}">
        <h5>Detalles del paquete</h5>
        <p><strong>Cabina:</strong> <span id="cabinaTipo"></span></p>
        <p><strong>Descripci√≥n:</strong> <span id="descripcionPaq"></span></p>
        <p><strong>Precio por persona:</strong> S/. <span id="precioPaq"></span></p>
      </div>

      <div class="text-center mt-4">
        <button type="submit" class="btn btn-ocean btn-lg">Finalizar</button>
      </div>
    </form>
  </main>

  <footer th:replace="~{fragments/footer :: footerContent}"></footer>

  <script th:inline="javascript">
    /*<![CDATA[*/
    const paquetes = /*[[${paquetes}]]*/ [];
    const select = document.getElementById('paqueteSelect');
    const cabinaSpan = document.getElementById('cabinaTipo');
    const descSpan = document.getElementById('descripcionPaq');
    const precioSpan = document.getElementById('precioPaq');

    select.addEventListener('change', () => {
      const selected = paquetes.find(p => p.nombre_paq === select.value);
      if (selected) {
        cabinaSpan.textContent = selected.cabinatipo_paq.nombre_cabina;
        descSpan.textContent = selected.descripcion_paq;
        precioSpan.textContent = selected.prec_paq_uni;
      }
    });
    /*]]>*/
  </script>

  <script th:src="@{/node_modules/bootstrap/dist/js/bootstrap.bundle.min.js}"></script>
</body>

</html>
